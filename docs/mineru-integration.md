# MinerU 数据集成使用指南

## 概述

Navigator 现在支持直接加载 MinerU 的布局分析数据，无需分别导入多个 JSON 文件。这大大简化了工作流程，让您可以直接使用 MinerU 的输出结果。

## 功能特性

### 🎯 简化的数据加载
- **一键加载** - 只需选择一个 MinerU 数据文件
- **自动解析** - 自动提取页面布局、文本内容和大纲结构
- **智能识别** - 自动识别文本块、图像、表格、公式等内容类型

### 📊 支持的 MinerU 数据格式

Navigator 支持标准的 MinerU 输出格式，通常是包含 `pdf_info` 字段的 JSON 文件：

```json
{
  "pdf_info": [
    {
      "page_idx": 0,
      "page_size": [595, 842],
      "layout_bboxes": [...],
      "para_blocks": [
        {
          "type": "title",
          "bbox": [x1, y1, x2, y2],
          "lines": [
            {
              "bbox": [x1, y1, x2, y2],
              "spans": [
                {
                  "bbox": [x1, y1, x2, y2],
                  "content": "标题文本",
                  "type": "text"
                }
              ]
            }
          ]
        }
      ],
      "images": [...],
      "tables": [...],
      "interline_equations": [...]
    }
  ]
}
```

## 使用步骤

### 1. 准备 MinerU 数据文件

确保您有一个由 MinerU 生成的 JSON 文件，通常命名为：
- `*_middle.json`
- `*_layout.json`
- 或其他包含 `pdf_info` 字段的 JSON 文件

### 2. 启动 Navigator

```bash
npm run dev
```

### 3. 切换到布局视图

点击界面右上角的"布局视图"按钮，或使用快捷键 `vl`

### 4. 加载 MinerU 数据

- 点击"📊 加载 MinerU"按钮
- 选择您的 MinerU 数据文件
- 系统会自动解析并加载数据

### 5. 查看分析结果

加载成功后，您可以：
- 查看自动生成的文档大纲
- 在 PDF 上叠加显示布局分析结果
- 使用键盘快捷键导航文档

## 界面功能

### 🎨 可视化控制

- **布局框显示** (`vb`) - 显示/隐藏文本块边界框
- **图像区域** - 橙色虚线框标识图像区域
- **表格区域** - 红色虚线框标识表格区域
- **公式区域** - 紫色点线框标识数学公式

### 📋 大纲功能

- **自动生成** - 基于 MinerU 识别的标题自动生成大纲
- **层次结构** - 支持多级标题的树形结构
- **快速导航** - 点击大纲项目直接跳转到对应页面

### ⌨️ 快捷键

| 快捷键 | 功能 |
|--------|------|
| `vl` | 切换布局视图 |
| `vo` | 切换大纲显示 |
| `vb` | 切换布局框显示 |
| `j`/`k` | 上下翻页 |
| `Ctrl+O` | 打开PDF文件 |

## 数据质量指标

Navigator 会显示 MinerU 分析的质量指标：

- **页面统计** - 总页数、当前页码
- **内容统计** - 文本块、图像、表格、公式数量
- **置信度** - 各类型内容的识别置信度
- **页面尺寸** - 原始页面的像素尺寸

## 故障排除

### 常见问题

**Q: 文件加载失败**
A: 确保选择的是有效的 MinerU 格式文件，包含 `pdf_info` 字段

**Q: 大纲显示为空**
A: 检查 MinerU 数据中是否包含标题类型的文本块

**Q: 布局框位置不准确**
A: 确保 PDF 文件与 MinerU 分析的源文件一致

### 调试信息

开发模式下，您可以在浏览器控制台查看详细的加载日志：
- 文件解析状态
- 内容提取统计
- 错误信息详情

## 技术细节

### 数据转换流程

1. **文件读取** - 解析 JSON 格式的 MinerU 数据
2. **结构提取** - 从 `para_blocks` 提取文本内容
3. **大纲生成** - 基于 `type: "title"` 的块生成大纲
4. **坐标转换** - 将 MinerU 坐标转换为 PDF 显示坐标

### 性能优化

- **按需加载** - 只在切换到布局视图时处理数据
- **内存管理** - 自动清理不再使用的数据
- **缓存机制** - 避免重复解析相同文件

## 与传统方式的对比

| 特性 | 传统方式 | MinerU 集成 |
|------|----------|-------------|
| 文件数量 | 3个JSON文件 | 1个JSON文件 |
| 加载步骤 | 依次选择3个文件 | 一次选择完成 |
| 数据质量 | 基础布局检测 | 高精度多模态分析 |
| 内容类型 | 有限支持 | 全面支持 |
| 置信度 | 无 | 详细置信度评分 |

## 未来扩展

计划中的功能增强：
- 支持更多 MinerU 输出格式
- 集成 OCR 质量评估
- 支持批量文档处理
- 导出分析结果

---

通过 MinerU 集成，Navigator 提供了更简洁、更强大的文档分析体验。如有问题或建议，欢迎反馈！ 